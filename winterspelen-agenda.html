<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Winterspelen 2026 - Google Agenda Tool</title>
    <style>
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0a1628; color: #e0e6ed; min-height: 100vh; }
        .container { max-width: 900px; margin: 0 auto; padding: 20px; }
        h1 { text-align: center; margin-bottom: 8px; font-size: 1.8em; background: linear-gradient(135deg, #60a5fa, #a78bfa); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .subtitle { text-align: center; color: #7a8ba3; margin-bottom: 24px; font-size: 0.95em; }
        .filters { display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 24px; justify-content: center; }
        .filter-btn { padding: 8px 16px; border: 1px solid #2a3a52; border-radius: 20px; background: #131f33; color: #94a3b8; cursor: pointer; font-size: 0.85em; transition: all 0.2s; }
        .filter-btn:hover { border-color: #60a5fa; color: #60a5fa; }
        .filter-btn.active { background: #1e3a5f; border-color: #60a5fa; color: #60a5fa; }
        .filter-btn.all { background: #1a2744; border-color: #4a6fa5; color: #8ab4f8; }
        .filter-btn.all.active { background: #1e3a5f; border-color: #60a5fa; color: #60a5fa; }
        .actions-bar { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding: 0 4px; flex-wrap: wrap; gap: 8px; }
        .select-all-wrap { display: flex; align-items: center; gap: 8px; }
        .select-all-wrap input { width: 18px; height: 18px; cursor: pointer; accent-color: #60a5fa; }
        .select-all-wrap label { color: #7a8ba3; cursor: pointer; font-size: 0.9em; }
        .btn-group { display: flex; gap: 8px; flex-wrap: wrap; }
        .add-selected { padding: 8px 20px; border: none; border-radius: 8px; background: linear-gradient(135deg, #2563eb, #7c3aed); color: white; cursor: pointer; font-size: 0.9em; font-weight: 600; transition: opacity 0.2s; }
        .add-selected:hover { opacity: 0.9; }
        .add-selected:disabled { opacity: 0.4; cursor: not-allowed; }
        .download-ics { padding: 8px 20px; border: 1px solid #2a3a52; border-radius: 8px; background: transparent; color: #94a3b8; cursor: pointer; font-size: 0.9em; font-weight: 600; transition: all 0.2s; }
        .download-ics:hover { border-color: #60a5fa; color: #60a5fa; }
        .download-ics:disabled { opacity: 0.4; cursor: not-allowed; }
        .count-badge { background: #1e3a5f; color: #60a5fa; padding: 2px 8px; border-radius: 10px; font-size: 0.8em; margin-left: 6px; }
        .day-group { margin-bottom: 20px; }
        .day-header { font-size: 1.1em; font-weight: 700; color: #60a5fa; padding: 10px 0 8px 4px; border-bottom: 1px solid #1e2d44; margin-bottom: 8px; position: sticky; top: 0; background: #0a1628; z-index: 1; }
        .event-card { display: flex; align-items: center; gap: 12px; padding: 10px 12px; border-radius: 8px; margin-bottom: 4px; transition: background 0.15s; cursor: pointer; }
        .event-card:hover { background: #131f33; }
        .event-card input[type="checkbox"] { width: 18px; height: 18px; flex-shrink: 0; cursor: pointer; accent-color: #60a5fa; }
        .event-time { font-weight: 600; color: #8ab4f8; min-width: 50px; font-size: 0.9em; }
        .event-details { flex: 1; }
        .event-title { font-size: 0.9em; color: #e0e6ed; display: flex; align-items: center; gap: 6px; flex-wrap: wrap; }
        .event-athletes { font-size: 0.8em; color: #6b7f99; margin-top: 2px; }
        .sport-tag { font-size: 0.7em; padding: 2px 8px; border-radius: 10px; font-weight: 500; flex-shrink: 0; }
        .tag-schaatsen { background: #1a3350; color: #60a5fa; }
        .tag-shorttrack { background: #1a3340; color: #34d399; }
        .tag-snowboarden { background: #2d1f3d; color: #a78bfa; }
        .tag-skeleton { background: #3d2b1a; color: #fbbf24; }
        .tag-bobsleeen { background: #3d1a1a; color: #f87171; }
        .tag-kunstrijden { background: #1a3d3d; color: #67e8f9; }
        .tag-ceremonie { background: #3d3d1a; color: #fde68a; }
        .hidden { display: none; }
        .no-results { text-align: center; padding: 40px; color: #4a5f7a; }
        #eventList { padding-bottom: 70px; }
        .method-info { text-align: center; color: #4a6580; font-size: 0.8em; margin-bottom: 16px; padding: 10px; background: #0d1b2e; border-radius: 8px; border: 1px solid #1e2d44; line-height: 1.5; }
        .method-info strong { color: #60a5fa; }
        .floating-bar { position: fixed; bottom: 0; left: 0; right: 0; background: #0d1b2e; border-top: 1px solid #1e2d44; padding: 12px 20px; display: flex; justify-content: center; align-items: center; gap: 12px; z-index: 50; transform: translateY(100%); transition: transform 0.3s ease; }
        .floating-bar.visible { transform: translateY(0); }
        .floating-bar .count-badge { background: #1e3a5f; color: #60a5fa; padding: 4px 10px; border-radius: 10px; font-size: 0.85em; }
        .event-gcal { flex-shrink: 0; padding: 6px 12px; border: 1px solid #2a3a52; border-radius: 6px; background: transparent; color: #7a8ba3; cursor: pointer; font-size: 0.8em; transition: all 0.2s; text-decoration: none; }
        .event-gcal:hover { border-color: #60a5fa; color: #60a5fa; }
        @media (max-width: 600px) {
            .event-card { flex-wrap: wrap; }
            .event-gcal { width: 100%; text-align: center; margin-top: 4px; }
        }
    </style>
</head>
<body>
<div class="container">
    <h1>Winterspelen Milano Cortina 2026</h1>
    <p class="subtitle">Nederlandse deelnemers - Google Agenda Tool</p>

    <div class="filters" id="filters"></div>

    <div class="actions-bar">
        <div class="select-all-wrap">
            <input type="checkbox" id="selectAll">
            <label for="selectAll">Alles selecteren</label>
            <span class="count-badge" id="countBadge">0 geselecteerd</span>
        </div>
    </div>

    <div class="method-info" id="methodDesktop">
        <strong>Hoe werkt het?</strong><br>
        <strong>+ Agenda</strong> &mdash; Voegt het event direct toe aan je Google Agenda<br>
        <strong>Download .ics</strong> &mdash; Selecteer meerdere events met de checkboxes en download ze als bestand. Importeer via <a href="https://calendar.google.com/calendar/r/settings/export" target="_blank" style="color:#60a5fa;">Google Agenda &rarr; Instellingen &rarr; Importeren</a> of open het bestand voor Apple Agenda
    </div>
    <div class="method-info" id="methodMobile" style="display:none;">
        <strong>Hoe werkt het?</strong><br>
        <strong>+ Agenda</strong> &mdash; Voegt het event direct toe aan je Google Agenda<br>
        <strong>Download .ics</strong> &mdash; Selecteer meerdere events met de checkboxes en download ze als bestand. Open het bestand en voeg de events toe!
    </div>

    <div id="eventList"></div>
</div>

<div class="floating-bar" id="floatingBar">
    <span class="count-badge" id="floatingCount">0 geselecteerd</span>
    <button class="add-selected" id="downloadIcs">Download .ics</button>
</div>

<script>
const events = [
    // Vrijdag 6 februari
    { date: "2026-02-06", day: "Vrijdag 6 februari", time: "20:00", endTime: "22:30", sport: "Ceremonie", title: "Openingsceremonie", athletes: "Nederland" },

    // Zaterdag 7 februari
    { date: "2026-02-07", day: "Zaterdag 7 februari", time: "16:00", endTime: "17:35", sport: "Schaatsen", title: "3000 meter (v)", athletes: "Merel Conijn, Antoinette Rijpma-de Jong, Bente Kerkhoff" },

    // Zondag 8 februari
    { date: "2026-02-08", day: "Zondag 8 februari", time: "09:00", endTime: "10:30", sport: "Snowboarden", title: "Parallelreuzenslalom (v), kwalificaties", athletes: "Michelle Dekker" },
    { date: "2026-02-08", day: "Zondag 8 februari", time: "13:00", endTime: "13:45", sport: "Snowboarden", title: "Parallelreuzenslalom (v), achtste finales", athletes: "mogelijk Michelle Dekker" },
    { date: "2026-02-08", day: "Zondag 8 februari", time: "13:48", endTime: "14:10", sport: "Snowboarden", title: "Parallelreuzenslalom (v), kwartfinales", athletes: "mogelijk Michelle Dekker" },
    { date: "2026-02-08", day: "Zondag 8 februari", time: "14:12", endTime: "14:27", sport: "Snowboarden", title: "Parallelreuzenslalom (v), halve finales", athletes: "mogelijk Michelle Dekker" },
    { date: "2026-02-08", day: "Zondag 8 februari", time: "14:29", endTime: "14:50", sport: "Snowboarden", title: "Parallelreuzenslalom (v), finale", athletes: "mogelijk Michelle Dekker" },
    { date: "2026-02-08", day: "Zondag 8 februari", time: "16:00", endTime: "18:15", sport: "Schaatsen", title: "5000 meter (m)", athletes: "Stijn van de Bunt, Chris Huizinga, Marcel Bosker" },
    { date: "2026-02-08", day: "Zondag 8 februari", time: "19:30", endTime: "21:00", sport: "Snowboarden", title: "Big air (v), kwalificaties", athletes: "Melissa Peperkamp, Romy van Vreden" },

    // Maandag 9 februari
    { date: "2026-02-09", day: "Maandag 9 februari", time: "17:30", endTime: "19:10", sport: "Schaatsen", title: "1000 meter (v)", athletes: "Jutta Leerdam, Femke Kok, Suzanne Schulting" },
    { date: "2026-02-09", day: "Maandag 9 februari", time: "19:30", endTime: "20:30", sport: "Snowboarden", title: "Big air (v), finale", athletes: "mogelijk Melissa Peperkamp, Romy van Vreden" },

    // Dinsdag 10 februari
    { date: "2026-02-10", day: "Dinsdag 10 februari", time: "10:30", endTime: "11:05", sport: "Shorttrack", title: "500 meter (v), series", athletes: "Xandra Velzeboer, Michelle Velzeboer, Selma Poutsma" },
    { date: "2026-02-10", day: "Dinsdag 10 februari", time: "11:08", endTime: "11:50", sport: "Shorttrack", title: "1000 meter (m), series", athletes: "Jens van 't Wout, Teun Boer, Melle van 't Wout" },
    { date: "2026-02-10", day: "Dinsdag 10 februari", time: "11:53", endTime: "12:20", sport: "Shorttrack", title: "Mixed relay, kwartfinales", athletes: "Nederland" },
    { date: "2026-02-10", day: "Dinsdag 10 februari", time: "12:23", endTime: "12:53", sport: "Shorttrack", title: "Mixed relay, halve finales", athletes: "mogelijk Nederland" },
    { date: "2026-02-10", day: "Dinsdag 10 februari", time: "12:56", endTime: "13:15", sport: "Shorttrack", title: "Mixed relay, finale", athletes: "mogelijk Nederland" },

    // Woensdag 11 februari
    { date: "2026-02-11", day: "Woensdag 11 februari", time: "18:30", endTime: "20:00", sport: "Schaatsen", title: "1000 meter (m)", athletes: "Jenning de Boo, Joep Wennemars, Kjeld Nuis" },

    // Donderdag 12 februari
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "10:00", endTime: "11:30", sport: "Snowboarden", title: "Cross (m), kwalificaties", athletes: "Glenn de Blois" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "13:45", endTime: "14:15", sport: "Snowboarden", title: "Cross (m), achtste finales", athletes: "mogelijk Glenn de Blois" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "14:18", endTime: "14:36", sport: "Snowboarden", title: "Cross (m), kwartfinales", athletes: "mogelijk Glenn de Blois" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "14:39", endTime: "14:54", sport: "Snowboarden", title: "Cross (m), halve finales", athletes: "mogelijk Glenn de Blois" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "14:56", endTime: "15:15", sport: "Snowboarden", title: "Cross (m), finale", athletes: "mogelijk Glenn de Blois" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "16:30", endTime: "18:30", sport: "Schaatsen", title: "5000 meter (v)", athletes: "Merel Conijn, Bente Kerkhoff" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "20:15", endTime: "20:27", sport: "Shorttrack", title: "500 meter (v), kwartfinales", athletes: "mogelijk Xandra Velzeboer, Michelle Velzeboer, Selma Poutsma" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "20:29", endTime: "20:55", sport: "Shorttrack", title: "1000 meter (m), kwartfinales", athletes: "mogelijk Jens van 't Wout, Teun Boer, Melle van 't Wout" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "20:58", endTime: "21:03", sport: "Shorttrack", title: "500 meter (v), halve finales", athletes: "mogelijk Xandra Velzeboer, Michelle Velzeboer, Selma Poutsma" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "21:05", endTime: "21:28", sport: "Shorttrack", title: "1000 meter (m), halve finales", athletes: "mogelijk Jens van 't Wout, Teun Boer, Melle van 't Wout" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "21:31", endTime: "21:40", sport: "Shorttrack", title: "500 meter (v), finale", athletes: "mogelijk Xandra Velzeboer, Michelle Velzeboer, Selma Poutsma" },
    { date: "2026-02-12", day: "Donderdag 12 februari", time: "21:43", endTime: "21:55", sport: "Shorttrack", title: "1000 meter (m), finale", athletes: "mogelijk Jens van 't Wout, Teun Boer, Melle van 't Wout" },

    // Vrijdag 13 februari
    { date: "2026-02-13", day: "Vrijdag 13 februari", time: "16:00", endTime: "18:30", sport: "Schaatsen", title: "10.000 meter (m)", athletes: "Stijn van de Bunt, Jorrit Bergsma" },
    { date: "2026-02-13", day: "Vrijdag 13 februari", time: "16:00", endTime: "17:45", sport: "Skeleton", title: "Heat 1 & 2 (v)", athletes: "Kimberley Bos" },

    // Zaterdag 14 februari
    { date: "2026-02-14", day: "Zaterdag 14 februari", time: "16:00", endTime: "16:50", sport: "Schaatsen", title: "Ploegenachtervolging (v), kwartfinales", athletes: "Antoinette Rijpma-de Jong, Merel Conijn, Bente Kerkhoff" },
    { date: "2026-02-14", day: "Zaterdag 14 februari", time: "17:00", endTime: "18:00", sport: "Schaatsen", title: "500 meter (m)", athletes: "Jenning de Boo, Sebas Diniz, Joep Wennemars" },
    { date: "2026-02-14", day: "Zaterdag 14 februari", time: "18:00", endTime: "19:40", sport: "Skeleton", title: "Heat 3 & 4 (v)", athletes: "Kimberley Bos" },
    { date: "2026-02-14", day: "Zaterdag 14 februari", time: "20:15", endTime: "20:55", sport: "Shorttrack", title: "1500 meter (m), kwartfinales", athletes: "mogelijk Jens van 't Wout, Friso Emons, Itzhak de Laat" },
    { date: "2026-02-14", day: "Zaterdag 14 februari", time: "20:59", endTime: "21:40", sport: "Shorttrack", title: "1000 meter (v), series", athletes: "Xandra Velzeboer, Michelle Velzeboer, Suzanne Schulting" },
    { date: "2026-02-14", day: "Zaterdag 14 februari", time: "21:44", endTime: "21:58", sport: "Shorttrack", title: "1500 meter (m), halve finales", athletes: "mogelijk Jens van 't Wout, Friso Emons, Itzhak de Laat" },
    { date: "2026-02-14", day: "Zaterdag 14 februari", time: "22:00", endTime: "22:30", sport: "Shorttrack", title: "Aflossing (v), halve finales", athletes: "Nederland" },
    { date: "2026-02-14", day: "Zaterdag 14 februari", time: "22:34", endTime: "22:50", sport: "Shorttrack", title: "1500 meter (m), finale", athletes: "mogelijk Jens van 't Wout, Friso Emons, Itzhak de Laat" },

    // Zondag 15 februari
    { date: "2026-02-15", day: "Zondag 15 februari", time: "16:00", endTime: "16:50", sport: "Schaatsen", title: "Ploegenachtervolging (m), kwartfinales", athletes: "Joep Wennemars, Chris Huizinga, Marcel Bosker" },
    { date: "2026-02-15", day: "Zondag 15 februari", time: "17:03", endTime: "18:00", sport: "Schaatsen", title: "500 meter (v)", athletes: "Femke Kok, Jutta Leerdam, Anna Boersma" },
    { date: "2026-02-15", day: "Zondag 15 februari", time: "19:45", endTime: "22:30", sport: "Kunstrijden", title: "Paren, korte kür", athletes: "Michel Tsiba, Daria Danilova" },

    // Maandag 16 februari
    { date: "2026-02-16", day: "Maandag 16 februari", time: "10:00", endTime: "11:55", sport: "Bobsleeën", title: "Tweemansbob (m), heat 1 & 2", athletes: "Dave Wesselink, Jelen Franjic (reserves: Janko Franjic, Dennis Veenstra)" },
    { date: "2026-02-16", day: "Maandag 16 februari", time: "10:30", endTime: "12:30", sport: "Snowboarden", title: "Slopestyle (v), kwalificaties", athletes: "Melissa Peperkamp, Romy van Vreden" },
    { date: "2026-02-16", day: "Maandag 16 februari", time: "11:00", endTime: "11:15", sport: "Shorttrack", title: "1000 meter (v), kwartfinales", athletes: "mogelijk Xandra Velzeboer, Michelle Velzeboer, Suzanne Schulting" },
    { date: "2026-02-16", day: "Maandag 16 februari", time: "11:18", endTime: "11:53", sport: "Shorttrack", title: "500 meter (m), series", athletes: "Jens van 't Wout, Teun Boer, Melle van 't Wout" },
    { date: "2026-02-16", day: "Maandag 16 februari", time: "11:55", endTime: "12:02", sport: "Shorttrack", title: "1000 meter (v), halve finales", athletes: "mogelijk Xandra Velzeboer, Michelle Velzeboer, Suzanne Schulting" },
    { date: "2026-02-16", day: "Maandag 16 februari", time: "12:04", endTime: "12:40", sport: "Shorttrack", title: "Aflossing (m), halve finales", athletes: "Nederland" },
    { date: "2026-02-16", day: "Maandag 16 februari", time: "12:42", endTime: "12:55", sport: "Shorttrack", title: "1000 meter (v), finale", athletes: "mogelijk Xandra Velzeboer, Michelle Velzeboer, Suzanne Schulting" },
    { date: "2026-02-16", day: "Maandag 16 februari", time: "20:00", endTime: "23:00", sport: "Kunstrijden", title: "Paren, vrije kür", athletes: "mogelijk Michel Tsiba, Daria Danilova" },

    // Dinsdag 17 februari
    { date: "2026-02-17", day: "Dinsdag 17 februari", time: "13:00", endTime: "14:20", sport: "Snowboarden", title: "Slopestyle (v), finale", athletes: "mogelijk Melissa Peperkamp, Romy van Vreden" },
    { date: "2026-02-17", day: "Dinsdag 17 februari", time: "14:30", endTime: "14:50", sport: "Schaatsen", title: "Ploegenachtervolging (m), halve finales", athletes: "mogelijk Joep Wennemars, Chris Huizinga, Marcel Bosker" },
    { date: "2026-02-17", day: "Dinsdag 17 februari", time: "14:52", endTime: "15:12", sport: "Schaatsen", title: "Ploegenachtervolging (v), halve finales", athletes: "mogelijk Antoinette Rijpma-de Jong, Merel Conijn, Bente Kerkhoff" },
    { date: "2026-02-17", day: "Dinsdag 17 februari", time: "16:28", endTime: "16:45", sport: "Schaatsen", title: "Ploegenachtervolging (m), finale", athletes: "mogelijk Joep Wennemars, Chris Huizinga, Marcel Bosker" },
    { date: "2026-02-17", day: "Dinsdag 17 februari", time: "16:47", endTime: "17:05", sport: "Schaatsen", title: "Ploegenachtervolging (v), finale", athletes: "mogelijk Antoinette Rijpma-de Jong, Merel Conijn, Bente Kerkhoff" },
    { date: "2026-02-17", day: "Dinsdag 17 februari", time: "19:00", endTime: "21:00", sport: "Bobsleeën", title: "Tweemansbob (m), heat 3 & 4", athletes: "Dave Wesselink, Jelen Franjic (reserves: Janko Franjic, Dennis Veenstra)" },

    // Woensdag 18 februari
    { date: "2026-02-18", day: "Woensdag 18 februari", time: "20:15", endTime: "20:40", sport: "Shorttrack", title: "500 meter (m), kwart- en halve finales", athletes: "mogelijk Jens van 't Wout, Teun Boer, Melle van 't Wout" },
    { date: "2026-02-18", day: "Woensdag 18 februari", time: "20:59", endTime: "21:25", sport: "Shorttrack", title: "Aflossing (v), finale", athletes: "mogelijk Nederland" },
    { date: "2026-02-18", day: "Woensdag 18 februari", time: "21:29", endTime: "21:40", sport: "Shorttrack", title: "500 meter (m), finale", athletes: "mogelijk Jens van 't Wout, Teun Boer, Melle van 't Wout" },

    // Donderdag 19 februari
    { date: "2026-02-19", day: "Donderdag 19 februari", time: "16:30", endTime: "18:20", sport: "Schaatsen", title: "1500 meter (m)", athletes: "Joep Wennemars, Tijmen Snel, Kjeld Nuis" },

    // Vrijdag 20 februari
    { date: "2026-02-20", day: "Vrijdag 20 februari", time: "16:30", endTime: "18:20", sport: "Schaatsen", title: "1500 meter (v)", athletes: "Marijke Groenewoud, Antoinette Rijpma-de Jong, Femke Kok" },
    { date: "2026-02-20", day: "Vrijdag 20 februari", time: "20:15", endTime: "20:55", sport: "Shorttrack", title: "1500 meter (v), kwartfinales", athletes: "Suzanne Schulting, Xandra Velzeboer, Selma Poutsma" },
    { date: "2026-02-20", day: "Vrijdag 20 februari", time: "21:00", endTime: "21:25", sport: "Shorttrack", title: "1500 meter (v), halve finales", athletes: "mogelijk Suzanne Schulting, Xandra Velzeboer, Selma Poutsma" },
    { date: "2026-02-20", day: "Vrijdag 20 februari", time: "21:29", endTime: "22:00", sport: "Shorttrack", title: "Aflossing (m), finale", athletes: "mogelijk Nederland" },
    { date: "2026-02-20", day: "Vrijdag 20 februari", time: "22:03", endTime: "22:15", sport: "Shorttrack", title: "1500 meter (v), finale", athletes: "mogelijk Suzanne Schulting, Xandra Velzeboer, Selma Poutsma" },

    // Zaterdag 21 februari
    { date: "2026-02-21", day: "Zaterdag 21 februari", time: "10:00", endTime: "11:55", sport: "Bobsleeën", title: "Viermansbob (m), heat 1 & 2", athletes: "Timme Koster, Jelen Franjic, Janko Franjic, Dave Wesselink (reserve: Dennis Veenstra)" },
    { date: "2026-02-21", day: "Zaterdag 21 februari", time: "15:00", endTime: "15:45", sport: "Schaatsen", title: "Massastart (m), halve finales", athletes: "Jorrit Bergsma, Stijn van de Bunt" },
    { date: "2026-02-21", day: "Zaterdag 21 februari", time: "15:50", endTime: "16:35", sport: "Schaatsen", title: "Massastart (v), halve finales", athletes: "Marijke Groenewoud, Bente Kerkhoff" },
    { date: "2026-02-21", day: "Zaterdag 21 februari", time: "16:40", endTime: "17:10", sport: "Schaatsen", title: "Massastart (m), finale", athletes: "mogelijk Jorrit Bergsma, Stijn van de Bunt" },
    { date: "2026-02-21", day: "Zaterdag 21 februari", time: "17:15", endTime: "17:45", sport: "Schaatsen", title: "Massastart (v), finale", athletes: "mogelijk Marijke Groenewoud, Bente Kerkhoff" },

    // Zondag 22 februari
    { date: "2026-02-22", day: "Zondag 22 februari", time: "10:00", endTime: "11:55", sport: "Bobsleeën", title: "Viermansbob (m), heat 3 & 4", athletes: "Timme Koster, Jelen Franjic, Janko Franjic, Dave Wesselink (reserve: Dennis Veenstra)" },
    { date: "2026-02-22", day: "Zondag 22 februari", time: "20:00", endTime: "23:00", sport: "Ceremonie", title: "Sluitingsceremonie", athletes: "Nederland" },
];

const sports = [...new Set(events.map(e => e.sport))].sort();
const sportClasses = {
    "Schaatsen": "tag-schaatsen",
    "Shorttrack": "tag-shorttrack",
    "Snowboarden": "tag-snowboarden",
    "Skeleton": "tag-skeleton",
    "Bobsleeën": "tag-bobsleeen",
    "Kunstrijden": "tag-kunstrijden",
    "Ceremonie": "tag-ceremonie"
};

let activeFilters = new Set();
let selectedEvents = new Set();

function initFilters() {
    const container = document.getElementById('filters');
    const allBtn = document.createElement('button');
    allBtn.className = 'filter-btn all active';
    allBtn.textContent = 'Alle sporten';
    allBtn.onclick = () => {
        activeFilters.clear();
        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
        allBtn.classList.add('active');
        renderEvents();
    };
    container.appendChild(allBtn);

    sports.forEach(sport => {
        const btn = document.createElement('button');
        btn.className = 'filter-btn';
        btn.textContent = sport;
        btn.onclick = () => {
            if (activeFilters.has(sport)) {
                activeFilters.delete(sport);
            } else {
                activeFilters.add(sport);
            }
            document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
            if (activeFilters.size === 0) {
                allBtn.classList.add('active');
            } else {
                activeFilters.forEach(s => {
                    [...container.children].find(b => b.textContent === s)?.classList.add('active');
                });
            }
            renderEvents();
        };
        container.appendChild(btn);
    });
}

function getGCalUrl(event) {
    const [h, m] = event.time.split(':');
    const start = new Date(event.date + 'T' + h.padStart(2,'0') + ':' + m.padStart(2,'0') + ':00');
    const [eh, em] = event.endTime.split(':');
    const end = new Date(event.date + 'T' + eh.padStart(2,'0') + ':' + em.padStart(2,'0') + ':00');
    const fmt = d => d.toISOString().replace(/[-:]/g, '').replace(/\.\d{3}/, '');
    const title = `${event.sport}: ${event.title}`;
    const details = `Deelnemers: ${event.athletes}`;
    return `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(title)}&dates=${fmt(start)}/${fmt(end)}&details=${encodeURIComponent(details)}&location=${encodeURIComponent('Milano Cortina, Italië')}`;
}

function toICSDate(date, time) {
    const [h, m] = time.split(':');
    return date.replace(/-/g, '') + 'T' + h.padStart(2,'0') + m.padStart(2,'0') + '00';
}

function toICSEndDate(date, endTime) {
    const [h, m] = endTime.split(':');
    return date.replace(/-/g, '') + 'T' + h.padStart(2,'0') + m.padStart(2,'0') + '00';
}

function escapeICS(str) {
    return str.replace(/\\/g, '\\\\').replace(/;/g, '\\;').replace(/,/g, '\\,').replace(/\n/g, '\\n');
}

function icsLine(line) {
    return line + '\r\n';
}

function generateICS(indices) {
    const now = new Date();
    const pad = n => String(n).padStart(2, '0');
    const dtstamp = now.getUTCFullYear() + pad(now.getUTCMonth()+1) + pad(now.getUTCDate()) + 'T' + pad(now.getUTCHours()) + pad(now.getUTCMinutes()) + pad(now.getUTCSeconds()) + 'Z';

    let ics = '';
    ics += icsLine('BEGIN:VCALENDAR');
    ics += icsLine('VERSION:2.0');
    ics += icsLine('PRODID:-//Winterspelen 2026//NL');
    ics += icsLine('CALSCALE:GREGORIAN');
    ics += icsLine('X-WR-CALNAME:Winterspelen 2026 NL');
    ics += icsLine('X-WR-TIMEZONE:Europe/Amsterdam');
    ics += icsLine('BEGIN:VTIMEZONE');
    ics += icsLine('TZID:Europe/Amsterdam');
    ics += icsLine('BEGIN:STANDARD');
    ics += icsLine('DTSTART:19701025T030000');
    ics += icsLine('RRULE:FREQ=YEARLY;BYDAY=-1SU;BYMONTH=10');
    ics += icsLine('TZOFFSETFROM:+0200');
    ics += icsLine('TZOFFSETTO:+0100');
    ics += icsLine('TZNAME:CET');
    ics += icsLine('END:STANDARD');
    ics += icsLine('BEGIN:DAYLIGHT');
    ics += icsLine('DTSTART:19700329T020000');
    ics += icsLine('RRULE:FREQ=YEARLY;BYDAY=-1SU;BYMONTH=3');
    ics += icsLine('TZOFFSETFROM:+0100');
    ics += icsLine('TZOFFSETTO:+0200');
    ics += icsLine('TZNAME:CEST');
    ics += icsLine('END:DAYLIGHT');
    ics += icsLine('END:VTIMEZONE');

    indices.forEach(idx => {
        const e = events[idx];
        const uid = `ws2026-${e.date}-${e.time.replace(':','')}-${idx}@olympical.nl`;
        const dtstart = toICSDate(e.date, e.time);
        const dtend = toICSEndDate(e.date, e.endTime);
        const summary = escapeICS(`${e.sport}: ${e.title}`);
        const description = escapeICS(`Deelnemers: ${e.athletes}`);

        ics += icsLine('BEGIN:VEVENT');
        ics += icsLine(`UID:${uid}`);
        ics += icsLine(`DTSTAMP:${dtstamp}`);
        ics += icsLine(`DTSTART;TZID=Europe/Amsterdam:${dtstart}`);
        ics += icsLine(`DTEND;TZID=Europe/Amsterdam:${dtend}`);
        ics += icsLine(`SUMMARY:${summary}`);
        ics += icsLine(`DESCRIPTION:${description}`);
        ics += icsLine(`LOCATION:${escapeICS('Milano Cortina, Italië')}`);
        ics += icsLine('STATUS:CONFIRMED');
        ics += icsLine('END:VEVENT');
    });

    ics += icsLine('END:VCALENDAR');
    return ics;
}

function downloadICS() {
    const selected = [...selectedEvents].sort((a,b) => a - b);
    if (selected.length === 0) return;

    const icsContent = generateICS(selected);
    const blob = new Blob([icsContent], { type: 'text/calendar' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'Winterspelen 2026.ics';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    setTimeout(() => URL.revokeObjectURL(url), 5000);
}

function updateCount() {
    const count = selectedEvents.size;
    document.getElementById('countBadge').textContent = `${count} geselecteerd`;
    document.getElementById('floatingCount').textContent = `${count} geselecteerd`;
    document.getElementById('floatingBar').classList.toggle('visible', count > 0);
}

function renderEvents() {
    const container = document.getElementById('eventList');
    const filtered = activeFilters.size === 0 ? events : events.filter(e => activeFilters.has(e.sport));

    if (filtered.length === 0) {
        container.innerHTML = '<div class="no-results">Geen evenementen gevonden</div>';
        return;
    }

    const grouped = {};
    filtered.forEach((e, i) => {
        const idx = events.indexOf(e);
        if (!grouped[e.day]) grouped[e.day] = [];
        grouped[e.day].push({ ...e, idx });
    });

    let html = '';
    for (const [day, dayEvents] of Object.entries(grouped)) {
        html += `<div class="day-group"><div class="day-header">${day}</div>`;
        dayEvents.forEach(e => {
            const checked = selectedEvents.has(e.idx) ? 'checked' : '';
            const tagClass = sportClasses[e.sport] || '';
            html += `
                <div class="event-card" onclick="toggleEvent(${e.idx}, event)">
                    <input type="checkbox" ${checked} data-idx="${e.idx}" onclick="event.stopPropagation(); toggleEvent(${e.idx}, event)">
                    <span class="event-time">${e.time}</span>
                    <div class="event-details">
                        <div class="event-title"><span class="sport-tag ${tagClass}">${e.sport}</span> ${e.title}</div>
                        <div class="event-athletes">${e.athletes}</div>
                    </div>
                    <a class="event-gcal" href="${getGCalUrl(e)}" target="_blank" onclick="event.stopPropagation()">+ Agenda</a>
                </div>`;
        });
        html += '</div>';
    }
    container.innerHTML = html;
    updateCount();
}

function toggleEvent(idx, evt) {
    if (evt.target.tagName === 'A') return;
    if (selectedEvents.has(idx)) {
        selectedEvents.delete(idx);
    } else {
        selectedEvents.add(idx);
    }
    const cb = document.querySelector(`input[data-idx="${idx}"]`);
    if (cb) cb.checked = selectedEvents.has(idx);
    updateCount();
}

document.getElementById('selectAll').addEventListener('change', function() {
    const filtered = activeFilters.size === 0 ? events : events.filter(e => activeFilters.has(e.sport));
    if (this.checked) {
        filtered.forEach(e => selectedEvents.add(events.indexOf(e)));
    } else {
        filtered.forEach(e => selectedEvents.delete(events.indexOf(e)));
    }
    document.querySelectorAll('.event-card input[type="checkbox"]').forEach(cb => {
        cb.checked = this.checked;
    });
    updateCount();
});

document.getElementById('downloadIcs').addEventListener('click', downloadICS);

initFilters();
renderEvents();

const isMobileDevice = /Android|iPhone|iPad|iPod/i.test(navigator.userAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
if (isMobileDevice) {
    document.getElementById('methodDesktop').style.display = 'none';
    document.getElementById('methodMobile').style.display = '';
}

const isIOS = /iPhone|iPad|iPod/i.test(navigator.userAgent) || (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1);
if (isIOS) {
    const isChromeIOS = /CriOS/i.test(navigator.userAgent);
    const overlay = document.createElement('div');
    overlay.style.cssText = 'position:fixed;inset:0;background:rgba(0,0,0,0.7);z-index:200;display:flex;justify-content:center;align-items:center;padding:20px;';
    overlay.innerHTML = '<div style="background:#0d1b2e;border:1px solid #1e2d44;border-radius:12px;padding:24px;max-width:400px;width:100%;text-align:center;">' +
        '<h3 style="color:#60a5fa;margin-bottom:12px;font-size:1.1em;">iOS werkt beperkt</h3>' +
        '<p style="color:#94a3b8;font-size:0.9em;line-height:1.5;margin-bottom:20px;">' +
        (isChromeIOS
            ? 'Events toevoegen aan Google Calendar werkt op iOS alleen per event met de +Agenda knop. Meerdere events tegelijk toevoegen werkt wel voor Apple Calendar via de Safari-browser. We raden aan Olympical te gebruiken op je Mac/Desktop om meerdere events in één keer toe te voegen aan Google Calendar of Outlook.'
            : 'Meerdere events tegelijk toevoegen is op iOS alleen compatible met Apple Calendar. Events toevoegen aan Google Calendar kan wel per event met de + Agenda knop. Gebruik Olympical op je desktop om meerdere events in één keer toe te voegen.') +
        '</p>' +
        '<button style="padding:8px 24px;border:none;border-radius:8px;background:linear-gradient(135deg,#2563eb,#7c3aed);color:white;cursor:pointer;font-size:0.9em;font-weight:600;" onclick="this.closest(\'div[style*=fixed]\').remove()">Begrepen</button>' +
        '</div>';
    document.body.appendChild(overlay);
}
</script>
</body>
</html>
